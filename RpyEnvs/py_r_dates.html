<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Galen Holt">

<title>Galen Holt - Complex passing py-R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<meta property="og:title" content="Galen Holt - Complex passing py-R">
<meta property="og:description" content="Old way of giving path to venv, new way is to set it in .Rprofile">
<meta property="og:site-name" content="Galen Holt">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Galen Holt</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../research.html">
 <span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../code_demos.html" aria-current="page">
 <span class="menu-text">Code Demos</span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Complex passing py-R</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../code_demos.html" class="sidebar-item-text sidebar-link">Code Demos</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Small how-tos</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../small_helpers/smallpieces.html" class="sidebar-item-text sidebar-link">Bits and pieces</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../small_helpers/quarto_notes.html" class="sidebar-item-text sidebar-link">Quarto notes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../setup/rstudio_themes.html" class="sidebar-item-text sidebar-link">Editing Rstudio themes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../small_helpers/zip_downloading.html" class="sidebar-item-text sidebar-link">Download and unpack zips</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../small_helpers/json_api_construction.html" class="sidebar-item-text sidebar-link">Building JSON syntax from R for API calls</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../small_helpers/list_names.html" class="sidebar-item-text sidebar-link">Naming rules for lists</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../publishing/private_github_figshare.html" class="sidebar-item-text sidebar-link">Creating Figshare from private github</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../small_helpers/error_handling.html" class="sidebar-item-text sidebar-link">Intro to error handling</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Plotting</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/ggplot_themes.html" class="sidebar-item-text sidebar-link">ggplot themes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/setting_colors_for_groups.html" class="sidebar-item-text sidebar-link">Consistent colors</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/tweaks_tricks.html" class="sidebar-item-text sidebar-link">Saving and themeing plots</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/hcl_exploration.html" class="sidebar-item-text sidebar-link">Exploring HCL colorspace</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/rgb_to_hex.html" class="sidebar-item-text sidebar-link">Converting RGB to hex colors</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/fonts.html" class="sidebar-item-text sidebar-link">Fonts</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/faded_colors.html" class="sidebar-item-text sidebar-link">Faded 2d colour ramps</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/math_in_ggplot.html" class="sidebar-item-text sidebar-link">Latex in ggplot with latex2exp</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Website</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../website_notes/quarto_website_github.html" class="sidebar-item-text sidebar-link">Getting started</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../website_notes/updating_website.html" class="sidebar-item-text sidebar-link">Updating and maintaining website</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Theory, simulation, statistics, probability</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../simmodelling/twoDautocorr.html" class="sidebar-item-text sidebar-link">Generate 2d autocorrelation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stats_probability/expected_shannon.html" class="sidebar-item-text sidebar-link">Bootstrapping the expected shannon diversity</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stats_probability/fitting_lognormals.html" class="sidebar-item-text sidebar-link">Intro to fitting lognormals</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stats_probability/shifting_normals.html" class="sidebar-item-text sidebar-link">Basic shifts of normal moments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stats_probability/fitting_truncated.html" class="sidebar-item-text sidebar-link">Shifting and fitting truncated lognormals</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Drones</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../drones/overlaps_reactive.html" class="sidebar-item-text sidebar-link">Calculations for flight planning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../drones/overlaps.html" class="sidebar-item-text sidebar-link">Figuring out flight plan calcs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pix4d/read_pix4d_outputs.html" class="sidebar-item-text sidebar-link">Reading and plotting pix4d outputs</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Observable</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../observable/trying_observable.html" class="sidebar-item-text sidebar-link">Figuring out how to use ojs chunks</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">R and python</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/python_setup.html" class="sidebar-item-text sidebar-link">Python environments with pyenv and poetry</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/py_in_rpkg.html" class="sidebar-item-text sidebar-link">Wrapping python in R package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/RandPython.html" class="sidebar-item-text sidebar-link">Using R and python together</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/R_py_shared_projects.html" class="sidebar-item-text sidebar-link">Shared R-py project structure</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/py_r_dates.html" class="sidebar-item-text sidebar-link active">Passing complex objects py-R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/R_py_type_passing.html" class="sidebar-item-text sidebar-link">Passing types between R and python</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/py_r_project_overview.html" class="sidebar-item-text sidebar-link">Overview of building R-py package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/python_nameerror.html" class="sidebar-item-text sidebar-link">Intermittent NameError py-R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/python_updated_functions.html" class="sidebar-item-text sidebar-link">Small python bits</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">Setting up projects</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/rig.html" class="sidebar-item-text sidebar-link">Managing old R versions with rig</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/managingprivate.html" class="sidebar-item-text sidebar-link">Private data for website repo</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../setup/R_in_VS.html" class="sidebar-item-text sidebar-link">Using R in VScode</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RpyEnvs/end_run_renv.html" class="sidebar-item-text sidebar-link">Dealing with renv failures</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">Building packages</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../package/package_creation.html" class="sidebar-item-text sidebar-link">First pass at building a package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../vicwater/vicwater_testing.html" class="sidebar-item-text sidebar-link">Testing VicWater API</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_acquisition/bom_gauges.html" class="sidebar-item-text sidebar-link">BOM gauge locations with httr2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../vicwater/vicwater_api_howtocall.html" class="sidebar-item-text sidebar-link">Experimenting with API calls for {vicwater}</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_acquisition/gauge_data_pre_gauge.html" class="sidebar-item-text sidebar-link">Data from pre-gauged periods</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../data_acquisition/ALA_data_pull.html" class="sidebar-item-text sidebar-link">Pulling data from Atlas of Living Australia</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">R parallel processing (general)</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/interrogating_parallel.html" class="sidebar-item-text sidebar-link">Interrogating parallel resources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/nested_parallel.html" class="sidebar-item-text sidebar-link">Testing nested parallelism</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/parallel_speed.html" class="sidebar-item-text sidebar-link">Speed-testing parallel</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/globals_speed.html" class="sidebar-item-text sidebar-link">Global objects and parallel speed</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/nested_dependent_iterations.html" class="sidebar-item-text sidebar-link">Dependencies of inner parallelism on outer</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">R parallel processing on HPC</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/hpc_ephemera.html" class="sidebar-item-text sidebar-link">HPC notes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/plans_and_hpc.html" class="sidebar-item-text sidebar-link">Using single-machine plans on HPC</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/initial_future_batchtools.html" class="sidebar-item-text sidebar-link">Figuring out future.batchtools</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/changing_batchtools_template.html" class="sidebar-item-text sidebar-link">Switching templates, matching to resources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/template_modification.html" class="sidebar-item-text sidebar-link">Modifying templates</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/master_persistence.html" class="sidebar-item-text sidebar-link">Consequences of master timing out</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/nested_parallel_hpc.html" class="sidebar-item-text sidebar-link">Nested parallel on HPC nodes and cores</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../parallelism/conditional_plans.html" class="sidebar-item-text sidebar-link">Conditional plans for local and HPC</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-issue" id="toc-the-issue" class="nav-link active" data-scroll-target="#the-issue">The issue</a>
  <ul class="collapse">
  <li><a href="#general-problem" id="toc-general-problem" class="nav-link" data-scroll-target="#general-problem">General problem</a></li>
  <li><a href="#a-demonstration-sort-of" id="toc-a-demonstration-sort-of" class="nav-link" data-scroll-target="#a-demonstration-sort-of">A demonstration (sort of)</a></li>
  <li><a href="#now-with-time" id="toc-now-with-time" class="nav-link" data-scroll-target="#now-with-time">Now, with time</a></li>
  <li><a href="#for-future-reference" id="toc-for-future-reference" class="nav-link" data-scroll-target="#for-future-reference">For future reference</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Complex passing py-R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Galen Holt </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell" data-hash="py_r_dates_cache/html/setup_b3011a4b5838529a58f31f5729a12498">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">root.dir =</span> rprojroot<span class="sc">::</span><span class="fu">find_rstudio_root_file</span>())</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Old way of giving path to venv, new way is to set it in <code>.Rprofile</code></p>
<div class="cell" data-hash="py_r_dates_cache/html/unnamed-chunk-1_47913a6ac64cfc5e1b82aeed44eb22bc">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># reticulate::use_virtualenv(file.path('RpyEnvs', 'pytesting', '.venv'), required = TRUE)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="py_r_dates_cache/html/unnamed-chunk-2_3fd6be59148cc08a014458b9717d1178">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-issue" class="level1">
<h1>The issue</h1>
<p>I previously did some very basic playing with using python and R <a href="../RpyEnvs/RandPython.html">in the same quarto doc</a>. I immediately ran into issues though when I tried to use it in a real project because I was no longer passing just simple objects back and forth.</p>
<p>The specific issue I ran into was that it was straighforward to pass a pandas dataframe, but if one of the columns has dates, they come in as a list of python environments containing the date objects. They can be parsed, but it takes <em>forever</em>. So the solution is to turn them into something else in python, pass the pandas, and re-date them.</p>
<section id="general-problem" class="level2">
<h2 class="anchored" data-anchor-id="general-problem">General problem</h2>
<p>The real issue here is when we bring a df into R from python and it has a list column with ‘environment’ in it. Then the conversion hasn’t really happened, and doing that conversion post-hoc has to convert every single environment, which is all rows. And that takes forever. It’s not necessarily dates (and as we can see below, sometimes they <em>do</em> work just fine). So, if that happens, rather than taking an eternity to <code>purrr</code> or otherwise go through the column to translate, just put it in something easier in py, bring it over, and put it back.</p>
<p>I do wish I had a better idea about <em>why</em> it happened. I’m sure as it happens more I’ll start to figure it out.</p>
<p>It’s possible this has been fixed in more recent {reticulate}, and that’s why I can’t reproduce? <a href="https://github.com/rstudio/reticulate/pull/1266" class="uri">https://github.com/rstudio/reticulate/pull/1266</a>. No, I’m still getting the error where I was before. Still struggling to replicate it, but it does happen in the original case.</p>
</section>
<section id="a-demonstration-sort-of" class="level2">
<h2 class="anchored" data-anchor-id="a-demonstration-sort-of">A demonstration (sort of)</h2>
<p>Say we have a pandas dataframe with a few columns of simple types (numeric, character) and 1000 rows</p>
<div class="cell" data-hash="py_r_dates_cache/html/unnamed-chunk-3_fc97649acdb474cd56a1e85c3ffd5ea9">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>randnums <span class="op">=</span> [random.gauss(<span class="dv">0</span>, <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>)]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>allchars <span class="op">=</span> <span class="bu">list</span>(string.ascii_lowercase) <span class="op">+</span> <span class="bu">list</span>(string.ascii_uppercase)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>randchars <span class="op">=</span> [random.choice(allchars) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>)]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>simpledf <span class="op">=</span> pd.DataFrame({<span class="st">'rand_nums'</span>: randnums, <span class="st">'rand_chars'</span>: randchars}, columns<span class="op">=</span>[<span class="st">'rand_nums'</span>, <span class="st">'rand_chars'</span>], index<span class="op">=</span><span class="bu">range</span>(<span class="dv">1000</span>))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>simpledf</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     rand_nums rand_chars
0    -1.435625          U
1     0.350753          e
2     1.459661          w
3    -0.880471          u
4    -0.760653          p
..         ...        ...
995   0.485717          E
996  -0.237177          p
997   1.019685          U
998   1.094408          C
999  -1.525452          M

[1000 rows x 2 columns]</code></pre>
</div>
</div>
<p>Now, we can get that into R without too much fuss using <code>py$</code>.</p>
<div class="cell" data-hash="py_r_dates_cache/html/unnamed-chunk-4_27e92c7d63324184b69dd601ebe2c9bf">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>rsimple <span class="ot">&lt;-</span> py<span class="sc">$</span>simpledf</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>rsimple</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         rand_nums rand_chars
1    -1.4356250829          U
2     0.3507532402          e
3     1.4596605257          w
4    -0.8804708136          u
5    -0.7606531555          p
6    -1.2408422400          a
7     0.8086022926          w
8     0.1553681838          I
9     0.1499931469          N
10   -1.6905648266          U
11    0.2735097750          J
12    0.7656201820          t
13   -0.1118194501          M
14    0.0195489805          Z
15    1.0395564063          d
16   -0.1745102607          V
17   -0.0554451868          l
18    2.5258639534          u
19   -0.1096351552          G
20    0.2815596223          I
21   -0.2717254117          p
22   -0.6813295226          S
23   -1.1741510134          x
24    0.6772420918          Q
25    1.5003135109          m
26    0.1937154814          f
27   -0.3254001300          h
28    2.1922539812          g
29    1.1573719445          J
30   -0.0007215734          v
31   -0.4449339143          V
32   -0.6919343708          X
33    0.3405342337          q
34    1.7239006058          W
35   -0.0064842740          m
36   -0.4052370276          p
37    0.2411737758          G
38    0.4890874441          c
39   -0.0497768017          c
40    0.3144387082          n
41   -0.5720470392          m
42    1.3898167198          W
43    0.1206725257          J
44    0.8840267607          Q
45   -1.5968558247          T
46   -0.2623930356          c
47   -0.3184930484          U
48    0.5905771314          W
49   -1.1009629286          P
50    0.2663333987          z
51    1.6098848034          Q
52    0.1156195038          v
53   -0.1574073941          v
54   -0.0220035782          a
55    0.4692603842          v
56   -2.1948482826          L
57    0.7017765392          d
58    0.3143708586          D
59    0.5112804985          Z
60   -1.1066206206          m
61   -1.9502416341          w
62   -0.0130923968          T
63    0.3933354221          M
64   -1.6776265650          A
65    0.7595630454          n
66   -0.4379569391          W
67    0.4705634414          p
68    0.6172425521          e
69   -0.7822788402          D
70   -0.0734679537          B
71    0.2588013336          K
72   -1.8202384489          l
73   -0.0657629065          C
74   -2.5026896570          q
75    1.9706540706          y
76    0.0761237398          a
77   -0.5691208781          Q
78    0.5843364893          S
79   -0.5815034410          J
80    1.8895772379          f
81   -0.2758890229          Y
82   -0.2267390165          J
83    0.9147952331          u
84    0.2913826871          O
85    0.9273477394          J
86   -1.1968127602          c
87    0.5527709545          Q
88   -0.2768357343          L
89   -0.7163124052          b
90   -0.1545520263          G
91   -0.9328695604          b
92   -1.1274812211          z
93   -1.3402513131          P
94    1.0497130347          u
95   -0.8909050504          V
96    0.6315742888          a
97   -0.1505737723          Q
98    1.0482120825          O
99   -0.2441229867          f
100  -0.7436569070          Y
101   0.8585831633          Y
102   0.2174317439          J
103  -2.1324529452          E
104  -0.6294762732          D
105  -1.5313542737          Y
106   0.8950773893          J
107  -0.9150658817          A
108   1.7269690792          n
109   1.2138556701          I
110  -0.2263987893          d
111   0.3058133383          X
112  -1.9207386398          w
113   0.4476041786          m
114   0.5174985196          y
115  -1.6798013843          a
116  -0.6543114023          l
117  -0.3858112352          y
118   0.1964507535          t
119   0.9569313976          z
120   0.5350902274          q
121   0.6451306060          T
122  -0.4024269994          C
123   0.9285307222          q
124  -0.4165565632          l
125  -0.9688939726          T
126   0.2783331164          h
127   1.8851084142          U
128   0.5594758648          M
129  -1.7098245945          c
130  -0.4873313623          o
131   0.1763417295          Y
132   0.2993006790          w
133  -2.1734429180          o
134  -0.6241570945          l
135  -0.1514943669          E
136   1.1687435451          E
137   0.2579055153          H
138   1.2060193818          w
139   1.0556381249          E
140  -0.5344922474          k
141   1.5665250820          K
142  -0.7679826974          W
143  -1.5371772325          r
144  -0.9831036374          G
145   0.5888212113          p
146   0.7912402080          d
147  -1.3955327843          N
148  -0.5898197310          I
149   0.4744448312          W
150   0.9603159543          G
151   2.6400880715          Z
152  -0.9741516568          j
153  -1.4112700642          J
154  -0.7592268061          h
155  -0.5696867131          Z
156   0.1077654988          N
157   0.2584803264          J
158  -0.5042422113          K
159   0.9500776329          I
160  -0.1630936146          S
161  -0.5806396607          A
162  -1.0818705328          H
163  -0.4924106609          j
164  -2.0783763152          T
165  -0.2960155852          v
166   1.4480343617          n
167   0.0124443684          z
168  -1.3783466819          O
169   0.9854687706          P
170   0.0743033311          y
171   0.8935141623          j
172   0.9373337643          b
173   0.8400493292          W
174   1.1587772141          o
175   0.4541633273          u
176  -0.9076626722          o
177  -0.0492898176          Z
178  -0.6963647511          A
179  -1.2348769677          i
180   0.9441149440          R
181  -1.3722730385          A
182   1.0466268517          p
183   0.9331375194          T
184  -0.9846034420          A
185  -0.5257966923          z
186   1.0656305613          i
187  -1.8448519003          o
188   0.3906398956          b
189  -0.7187897316          H
190   1.7997578131          y
191  -0.3585941310          i
192  -1.6334092433          u
193   0.5164272434          c
194   0.1100665212          r
195   1.0007529214          R
196   0.9594131524          Z
197  -0.6135962902          w
198   1.5363903478          m
199  -0.8191980108          z
200   0.1921218219          s
201  -0.6613979592          M
202  -0.3993682663          z
203  -0.8706114641          e
204  -0.9649416441          T
205   0.1691579534          j
206   0.7859223252          B
207   0.5452355720          m
208   1.1415107984          a
209  -0.0341986138          m
210  -0.2736673388          s
211   1.9545059960          o
212   0.5166064879          p
213  -1.2943858809          m
214  -0.0860733171          c
215   1.1033975021          V
216  -0.3235088778          P
217  -0.4308106016          S
218   0.5587407714          W
219   1.3721918439          g
220   0.5293768430          Q
221   0.0922332647          b
222  -0.4510724456          S
223   0.1751050964          v
224  -1.5745327122          P
225  -0.4686987790          k
226  -0.0314020510          a
227   0.1175743374          W
228   0.4499665765          u
229  -0.5197055690          h
230  -1.1473497325          g
231   0.0814614482          l
232  -0.4677117340          L
233  -1.0519902963          x
234   1.6068351716          C
235  -0.8488315795          d
236   0.3508745290          j
237  -1.6927363301          A
238   0.9013266352          B
239  -0.6471005275          w
240   1.3371939534          O
241   0.1646968304          E
242   1.5944426768          f
243  -0.1227216065          n
244  -0.3611438571          x
245   1.4321273859          g
246   0.7598238254          a
247   2.0796874924          j
248   0.9923193860          J
249   0.2693997486          X
250   1.4039850626          V
251  -0.9389568383          z
252   0.4740103282          z
253  -1.3101674090          x
254  -0.1034074744          E
255   0.4483205899          Y
256  -0.6589250104          T
257  -0.8429945222          J
258  -1.1663515480          z
259   1.9660000937          p
260  -0.3433573563          s
261   0.1148442635          q
262  -0.5249875766          Z
263   0.1676782899          n
264  -1.0136286479          J
265  -0.7333549673          j
266   0.8995466753          P
267   0.9695350837          Y
268   0.9218253542          K
269  -0.4414647146          Z
270   0.6155998382          Y
271  -1.7022643915          B
272   1.4796970719          a
273  -0.3965082786          X
274   0.3768646438          e
275   0.2447098868          B
276   0.4360737055          A
277  -0.9974945815          F
278  -0.1484822796          d
279  -1.4219579349          v
280   0.1011745791          e
281   0.8820198202          p
282   1.2388310771          X
283   0.7298684372          f
284  -0.1346159341          l
285   0.5706964135          u
286   0.6212584662          Q
287   0.3538824295          z
288  -0.8331870919          H
289  -0.1833103747          c
290  -0.3476566622          S
291   0.1821118186          C
292  -1.5433383481          B
293  -1.1503580712          Z
294  -0.8614605342          i
295   0.1128122810          t
296  -0.0985476579          s
297   0.4965837881          L
298   2.1192126466          B
299  -0.5390286611          i
300   0.4939689152          x
301  -0.9398666483          p
302   1.2112709605          b
303  -0.9908630925          U
304   1.0170897273          r
305  -0.5123478466          j
306  -0.3169409330          Q
307  -0.0496000290          U
308   1.5109416952          t
309   1.1367608816          N
310   0.1629503225          e
311   0.7811006908          z
312  -1.1362155603          L
313  -1.4870577788          q
314  -1.8360952594          T
315  -2.1588950838          K
316  -0.4326770520          t
317   0.7413403754          S
318  -0.4247797000          X
319   0.3798902630          m
320   0.2838859199          K
321  -1.4545669610          c
322  -1.0195341893          S
323  -1.6534753902          p
324   0.0749989437          H
325  -0.9867258338          t
326  -0.4742745878          D
327   1.2229742048          M
328  -2.5855681339          t
329  -1.6556717684          S
330  -1.1646784061          v
331   0.5203800497          D
332   0.5579600179          T
333   0.3906490013          f
334  -1.0328063769          x
335   1.0510518969          h
336   0.9208684701          W
337   0.4724651764          g
338   1.0679444841          d
339  -0.7056842927          t
340  -0.1534711408          K
341   0.3107689054          V
342   0.7546560251          W
343  -1.5540519197          N
344   2.4087434653          z
345   0.7456152114          Z
346   1.3882134808          p
347   0.3063834615          l
348  -0.2253811679          d
349   0.6709227969          f
350   0.6163450537          E
351   1.0458290120          q
352  -0.6950405211          Q
353   0.8089349122          G
354   1.5097777051          N
355   0.2409425751          z
356   0.2326360981          D
357   0.0179152979          p
358  -0.3539070323          T
359   0.1628877731          S
360  -0.3378879952          X
361  -1.0754435743          c
362  -1.0773125573          j
363  -0.6769689006          Q
364  -0.6280201939          H
365   0.8391456664          W
366   0.4610277130          u
367  -1.0067995950          d
368  -0.0689080065          U
369   1.2135150596          W
370   0.0094342522          h
371  -0.8918038513          y
372  -0.9509841561          L
373  -0.3823363638          L
374   0.9561179356          I
375   0.4782514730          L
376  -0.8988786030          K
377  -1.0871152944          z
378   0.9368828239          A
379  -2.0280363617          T
380   0.6950611166          t
381  -0.0778011249          o
382   0.4850504467          x
383  -0.1302079696          K
384  -0.6757692734          h
385  -1.0987856964          n
386   0.0631926768          q
387   0.7862546296          j
388  -1.1601220549          p
389  -1.6780539594          E
390  -0.0420252980          O
391  -0.8648674438          X
392  -0.6161887965          v
393  -1.2515025173          o
394   0.2614429133          u
395  -0.3355556764          L
396  -0.4623944123          a
397   0.1756127177          P
398  -0.5110623986          W
399  -2.4653633726          k
400   1.8300360514          X
401   1.2671240937          z
402  -2.2638218529          T
403  -0.4130177377          D
404  -1.5986772412          F
405  -0.9050381725          o
406  -0.2207035830          l
407   0.6872274530          z
408   0.1474403991          o
409   0.6622302218          c
410  -0.3503004232          l
411   0.4563815819          L
412   0.5701071199          C
413   0.0906618075          W
414   1.1819219448          E
415   0.4643936424          d
416  -0.4826000752          j
417   0.6778095083          W
418   0.3964221019          H
419  -0.6242097970          l
420  -1.8358501504          c
421  -0.2029451445          B
422  -1.4362061020          q
423   1.1718644480          k
424  -0.9584450813          a
425   0.1429398426          o
426  -0.1582334564          A
427   0.1017999980          U
428   0.2995843707          n
429  -0.8841513168          b
430  -0.3601259299          O
431  -1.0549965952          U
432   0.3215733096          O
433  -0.0753970105          y
434   1.7370206652          h
435   0.2147937492          S
436  -0.3126901358          Z
437   0.2484921691          p
438  -0.2256731246          Z
439  -0.1607114628          E
440  -1.1739196544          k
441   0.4915594650          l
442  -0.3356931812          K
443  -0.2034798788          p
444  -1.0406683943          m
445   0.7687679265          P
446   0.1908507424          o
447  -0.3661570524          b
448   0.0431516062          U
449  -0.5057734164          d
450  -0.5616106457          K
451  -0.3748887233          l
452   1.3901152999          Q
453  -0.3955657705          x
454  -0.1297649382          j
455   0.3468275607          H
456  -1.0361510068          u
457  -0.2491759501          P
458  -1.1182386653          x
459   0.0838799558          v
460   0.3027978827          t
461  -0.7197029213          j
462   0.1816761240          r
463  -0.1718854601          h
464   0.7719029424          j
465  -0.9477488874          p
466   0.7173881083          D
467  -1.7842144866          U
468  -0.8781683693          u
469  -0.1864393658          o
470  -1.8302325975          w
471  -0.2130204962          Z
472  -0.1042004829          o
473   0.3361470549          X
474  -0.3565092879          Q
475  -0.3805926689          N
476   0.2535289877          S
477   0.0670465047          A
478  -0.2399207624          R
479   0.1202291279          N
480  -1.3423960921          m
481  -1.9833013984          w
482  -0.0452814876          f
483   0.3224375385          d
484   0.4351273110          k
485  -1.0831513852          m
486  -0.7251690123          K
487   0.9957466415          Z
488   0.2255315070          N
489   0.2131987886          B
490  -0.3769222145          m
491   1.1495878927          P
492   0.0497512253          U
493  -0.4726971962          p
494  -0.4938457998          f
495  -1.1348367422          R
496   0.2258044721          V
497  -0.2224941741          m
498  -0.7362201810          Z
499   0.7199027875          T
500   2.4773327897          Y
501  -0.0347875918          w
502   1.6032305068          k
503   0.8043905486          I
504  -1.2078634918          r
505   0.1682168493          Q
506  -0.3653803913          V
507   1.6328767060          M
508  -0.2464734566          a
509   0.5052421295          E
510  -1.9298476370          W
511   1.0811950547          a
512  -0.8551932728          l
513  -1.2044521477          X
514  -0.0659345853          B
515  -1.9768769662          n
516  -0.1430651396          O
517  -0.5339352321          o
518   0.7579213368          x
519   0.5025175301          S
520   1.2866448311          t
521  -0.4127577384          K
522   0.5947399825          O
523  -0.0675055148          d
524   2.1361242061          d
525   0.6240153408          R
526  -0.1176965132          v
527  -0.2366361715          g
528   0.3510820282          U
529   0.4011780678          Z
530   0.9993635667          n
531  -0.6983236597          t
532  -0.9957448381          L
533   1.1252645724          Z
534   0.6181532731          i
535  -1.1917226797          w
536  -0.9919948974          Y
537  -0.2939287824          F
538  -0.6528311633          s
539   2.1459081731          e
540   2.2434053423          C
541   0.4085845431          b
542   0.2609584344          O
543  -0.7441409126          I
544  -2.4852425042          X
545   0.2907412532          J
546  -1.5814775669          f
547   0.8511448089          f
548   0.0112779500          O
549   0.9491043611          N
550  -0.1126119305          V
551  -0.7018560318          p
552   1.2813835016          H
553  -0.6879069731          h
554  -0.5398284709          D
555   0.6377341696          c
556   1.5764889807          G
557  -0.0363569839          I
558  -0.0343756704          a
559   1.0499723926          r
560  -0.6640957865          L
561  -1.2544309373          U
562  -0.8508860329          o
563  -1.1284958312          H
564   1.2427636510          D
565  -1.5351781274          V
566   1.6405571142          N
567  -0.0461611056          Y
568   1.8776265491          V
569   1.1385854881          Y
570   0.9208311341          m
571   0.8681816436          n
572  -0.1472896631          L
573   0.4536482734          r
574  -0.3272810523          x
575   0.3064916544          j
576   0.2614519362          r
577  -0.8630663069          Z
578  -1.0655756794          N
579   1.4327592285          F
580  -0.3160375981          k
581  -0.8802892399          f
582   1.9316729877          G
583  -0.1763009717          P
584   1.0921020778          v
585  -2.1345867632          v
586   0.5431402746          T
587  -0.8041737472          C
588  -1.0574402043          z
589   0.3675547284          W
590   0.8715992940          E
591   1.5273779412          M
592  -0.9326235932          r
593   0.4706451519          o
594   0.1338730339          l
595  -0.1177191566          B
596  -1.6273225103          l
597  -0.7543744425          s
598  -0.5449306407          T
599   0.7479379378          Y
600   1.8482179900          g
601  -1.1928893492          S
602  -1.5691268049          y
603  -0.3418812491          D
604   1.0241253681          c
605   0.2425019010          t
606   2.1736949337          Y
607   0.0431818921          y
608  -1.0681295830          c
609   0.5478019800          f
610   0.4336793012          B
611   0.9955053439          B
612  -0.8192227453          u
613   1.5524170984          Y
614   1.5550608816          X
615  -0.6538236589          U
616   1.0270757733          v
617  -1.4964887235          O
618   0.6572280476          n
619   1.5704374588          E
620  -0.8529470310          w
621   0.2923396089          m
622  -1.3231860831          d
623  -0.2959259351          z
624   0.5128084589          L
625   1.9487665318          b
626   1.3832244461          s
627   0.7132032233          Z
628   0.7645145552          o
629   1.4480694368          l
630  -0.3508976214          Y
631   0.4424745736          D
632   0.0203015891          t
633  -0.0553896461          a
634   1.0007560633          y
635  -1.7453024865          k
636   0.6697785697          n
637  -0.5467022986          m
638   0.0032872397          R
639   0.2466541497          C
640  -1.5805592606          o
641  -0.1628804257          t
642   0.3694406318          t
643  -0.7741426332          Q
644   0.8306277427          n
645   1.4438993600          A
646  -0.9006198323          u
647   0.0551616211          X
648  -0.5802660414          A
649   1.3339850366          H
650  -1.1218159915          l
651   1.3874433646          Z
652   1.7740418043          w
653  -0.3582909380          X
654   0.4326761979          N
655   1.8599260911          g
656  -0.0515589281          g
657  -0.1511704069          K
658   0.3654940739          I
659   0.0557857387          z
660  -0.0502144173          Z
661   0.0842921238          s
662   0.4217485205          I
663   0.5147079796          m
664  -0.6725174764          z
665   0.5500913935          A
666   1.1357859013          E
667  -0.7984130899          l
668  -0.7343596558          W
669  -1.3233067165          g
670  -1.2316997547          m
671   0.3999450357          R
672   0.8553828521          M
673  -1.6335708704          i
674   1.9483301680          y
675  -0.2870438394          K
676  -0.2566898911          y
677  -0.1474485335          U
678   1.3271215612          S
679  -0.8775754623          u
680  -1.2155830393          U
681  -0.3742011371          x
682  -2.6046994551          G
683  -0.0899833919          T
684   1.2835171321          V
685  -0.3292862529          G
686   1.1517375302          k
687  -1.3594397705          c
688  -0.1602953491          f
689   1.8073505470          p
690  -1.4322742841          b
691  -1.6973213261          a
692  -0.6134905020          j
693  -0.0363189681          f
694   0.6621925827          y
695   0.3289825598          F
696  -0.8761095232          O
697  -0.9252975332          Q
698  -0.5176435351          J
699  -1.0810739797          e
700  -0.5888644456          U
701   0.8421566796          w
702   1.4033958540          f
703   0.2411266087          Y
704   1.5716191408          s
705  -0.7147494606          m
706  -0.5004655310          B
707   0.8180332524          n
708   0.4936324665          w
709  -0.3363503058          h
710   0.8956559281          D
711   1.3828609744          z
712  -1.0550426109          F
713  -0.5347013594          L
714  -2.0748510390          B
715   0.7746284322          o
716  -1.3735907689          R
717  -0.0433717851          B
718   0.6912673950          J
719   1.9875243231          J
720   2.8204671588          q
721   0.3989149781          C
722   0.4718595017          n
723  -2.2086231807          W
724   0.7256647729          p
725  -0.6583667501          J
726  -0.9675114467          c
727  -0.6556954460          W
728  -1.7068210667          V
729  -0.8773345211          z
730  -0.8186130547          T
731   0.4052639884          l
732  -0.1938228269          t
733  -0.2826271572          O
734   0.5910284230          P
735  -0.7635431664          h
736  -0.3030584913          X
737   0.1754024233          Y
738   0.0978343197          w
739   0.4100248534          M
740  -0.4225321916          D
741   1.3220268905          f
742   0.3976846405          c
743   2.1278484651          r
744  -0.4867650066          V
745   0.0722010189          R
746   1.9933897199          t
747   1.3187658050          S
748  -0.3802935934          F
749  -0.4976430128          L
750   2.1900243405          i
751   0.6629678409          X
752  -0.1803383095          o
753   0.0204933652          z
754  -2.1891889427          m
755   1.9048633909          u
756   0.2938377722          d
757   0.1994997837          K
758   0.2222239450          E
759  -1.6525599612          w
760   0.4384764245          H
761  -1.0286405211          K
762  -0.0296379505          h
763   0.4701457916          N
764  -0.1823601942          K
765   1.6154218555          H
766  -0.5450943771          g
767   0.3097726597          z
768  -0.0867932970          V
769  -0.6806204747          x
770  -0.3355014464          r
771  -1.1927102668          Q
772   1.1238276485          A
773  -0.9660698463          q
774   0.6473753255          G
775  -0.6053154715          O
776   0.0045197549          l
777  -0.3501868355          j
778   1.6011580826          H
779  -0.8178530753          z
780  -0.3879562040          K
781   0.4709296364          E
782   1.0002000181          G
783  -0.3817134311          o
784  -2.1674858772          a
785  -1.3112834406          R
786  -0.7580238175          z
787   0.6833386923          X
788   0.1322410330          X
789  -0.9621452009          W
790  -0.5595904750          k
791   3.0578217912          k
792  -0.6154739539          g
793   1.6556115369          R
794   2.2258373143          P
795   0.2277487813          y
796  -0.8286467582          x
797   0.7158227141          m
798  -0.9130298867          Z
799   0.9293039234          s
800  -0.2277858542          v
801   1.5296430623          f
802   0.6914462416          s
803  -0.2046371192          M
804   0.2332155662          z
805   1.1283378241          j
806  -0.3242708910          i
807  -1.0138268307          l
808  -0.5306936141          Q
809  -0.5655371410          o
810  -0.6043960277          F
811  -1.4745518785          Y
812   1.4755494220          v
813   0.3559831243          H
814   1.2143564027          v
815   0.2595468206          x
816   0.1048913752          l
817  -2.2896758228          j
818  -0.2395335866          f
819  -0.7680140155          g
820  -0.1350853924          q
821   1.6345477170          i
822  -2.2050813285          s
823   0.2422273456          d
824  -0.0430926724          k
825   1.0375124386          M
826   0.7836401506          N
827  -0.9371478937          n
828   1.6934176466          d
829  -0.3028726917          i
830   0.7263125001          f
831   1.9958764851          b
832  -0.7165897118          w
833   0.0290052389          M
834  -0.4649404607          J
835   0.0194393456          v
836  -0.4933723973          M
837   2.6708817212          J
838   0.2259238232          V
839   0.9048908525          c
840  -0.2022703883          J
841   0.0625252408          G
842   1.2306453822          l
843  -0.2789331401          k
844  -0.5231596137          v
845  -1.0790768050          P
846  -0.2360754836          l
847  -1.4590440646          m
848  -1.8257195965          U
849   0.1257243001          G
850  -0.2377404895          Z
851   1.5569695911          I
852  -2.1104718809          y
853   1.0167074861          P
854  -0.0312058985          V
855   0.6917138377          z
856   1.3053289112          w
857  -0.5567598211          O
858  -0.8863754897          G
859  -2.0390878771          a
860  -0.5575362616          M
861  -1.3020316258          m
862   0.7165802028          K
863   0.3394295153          r
864  -0.2002441120          h
865  -0.5948763088          T
866   0.3490135895          k
867  -1.3994828976          n
868  -0.4499683720          W
869  -0.5712692443          c
870  -1.0725852952          S
871   0.1027209914          m
872   0.6762481615          B
873   1.7224167978          R
874   1.5573622091          x
875   1.0600675122          R
876  -0.1386146968          v
877  -0.9823891185          q
878   0.5442199737          i
879   0.7451978018          q
880  -1.7618681436          P
881   0.1218761799          e
882  -0.3191614840          V
883   2.5570525775          u
884   0.4453312361          r
885   0.4596987497          B
886  -1.6793739145          s
887   0.6694351160          t
888  -1.6186995845          g
889  -0.6517881144          C
890   1.2151781540          P
891   0.8251184813          I
892  -1.1935697693          B
893   0.4672807201          x
894  -0.5007378477          W
895   0.4095609602          j
896   0.7323162222          M
897  -1.0174594458          t
898  -0.1296055638          b
899   1.2862551180          D
900  -0.1908550020          A
901   0.9376658293          L
902  -1.5571643408          U
903   0.4181011101          m
904   0.3284572498          x
905  -0.5959016193          H
906   0.1422047525          u
907   0.1115222790          y
908  -1.0054665629          i
909  -1.5386254214          N
910  -1.0294034984          t
911  -0.5703681321          o
912   0.1264461308          m
913   0.3595942219          h
914  -0.0460875825          w
915  -0.6413127889          j
916  -0.0692236714          h
917  -0.2700500300          I
918  -1.4601067883          A
919  -0.4568255813          r
920   0.6550714209          S
921  -0.1869571432          t
922  -0.0807894839          z
923  -1.4176962902          x
924  -0.3173178517          y
925   0.1575146217          e
926  -2.1369432019          E
927   0.6528115331          v
928  -2.0608392945          V
929  -0.0869133045          I
930   0.6653643633          I
931   0.2230423898          R
932  -0.2204405248          n
933   1.6365320502          Z
934   1.3114448457          q
935   0.8474996999          O
936   0.3226254339          m
937   1.0237374383          D
938  -2.1620718248          E
939   0.1243898434          m
940  -2.2005427786          W
941   0.8433656779          g
942   0.7158068384          O
943   1.0535220331          k
944  -0.8527234159          T
945   0.7870504848          m
946   0.0934380270          q
947  -0.3628072450          B
948  -0.3309138033          H
949   1.1371379319          g
950   0.2866303292          L
951  -0.3149581319          S
952  -0.2192921616          j
953   0.8448657678          r
954   0.0280955747          r
955  -0.0878613950          X
956   0.0587217855          P
957   0.3899827194          e
958   0.9712651483          t
959  -0.0349161389          M
960   0.2044860319          F
961  -0.1828614216          i
962   0.8386614472          G
963  -0.9562269589          g
964   0.5364526538          r
965   2.8003546980          g
966   2.7849531652          e
967  -1.0016161232          C
968  -2.2279832640          a
969  -0.6641445078          R
970   2.8482495152          p
971  -0.4452859008          h
972   0.8324226326          h
973   1.8693815386          N
974   0.6081408181          J
975  -0.1499750710          P
976   0.4443449714          U
977   0.0082651354          G
978   0.7993040354          H
979  -1.4548646703          c
980  -1.3535649026          I
981   2.2544517991          V
982   0.0999063445          a
983   1.0053994577          s
984  -0.8113950478          o
985   0.0914670016          z
986  -0.8424450842          o
987  -0.3490376723          C
988  -0.5986849840          K
989  -0.5653782157          v
990   0.4517825416          v
991   1.3376457275          V
992   0.4849415228          M
993  -1.0763858087          n
994  -0.4583067943          a
995   0.3608778480          A
996   0.4857165248          E
997  -0.2371774650          p
998   1.0196845951          U
999   1.0944084292          C
1000 -1.5254522908          M</code></pre>
</div>
</div>
<p>Quick and easy. I <em>think</em> <code>py_to_r</code> is supposed to do some of this, but I can never get it to work. I think maybe it would make more sense in a script where we’re moving back and forth than here where we have separate code chunks?</p>
</section>
<section id="now-with-time" class="level2">
<h2 class="anchored" data-anchor-id="now-with-time">Now, with time</h2>
<p>Let’s add a column of dates to simpledf. First, create the dates, then add to simpledf.</p>
<div class="cell" data-hash="py_r_dates_cache/html/unnamed-chunk-5_c5daeaafd4f3ab6a679469dbadbedfae">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> []</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>d1 <span class="op">=</span> datetime.datetime.strptime(<span class="st">'2000-01-01'</span>, <span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Because i starts at 0, the first loop is the start date</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add i days to the start date</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    day_new <span class="op">=</span> d1 <span class="op">+</span> datetime.timedelta(days<span class="op">=</span>i)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Append the current date string to the list of dates</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    dates.append(day_new)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>timedf <span class="op">=</span> simpledf.assign(date <span class="op">=</span> dates)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Try another way too</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>timedf[<span class="st">'date2'</span>] <span class="op">=</span> pd.to_datetime(timedf[<span class="st">'date'</span>])</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, when we bring it into R, it just works? That’s not at all what happened to me when I had the original issue.</p>
<div class="cell" data-hash="py_r_dates_cache/html/unnamed-chunk-6_da447830f430d2c8b99537e2adab55c7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>timedfR <span class="ot">&lt;-</span> py<span class="sc">$</span>timedf</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble::as_tibble(timedfR)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="for-future-reference" class="level2">
<h2 class="anchored" data-anchor-id="for-future-reference">For future reference</h2>
<p>So, I can’t seem to replicate the issue. Previously, the datetime col came in as a list-col into a tibble, and was wrapped in a python environment. It was possible to parse it with <code>purrr</code> (or <code>lapply</code>, but <code>purrr</code> was <em>much</em> faster (and weirdly, <code>furrr</code> was slower). Not running, because this <em>isn’t</em> in a python env, and so this doesn’t actually work.</p>
<div class="cell" data-hash="py_r_dates_cache/html/unnamed-chunk-7_48595533b30af4a66648ed7f8e0b7bd2">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>demodates <span class="ot">&lt;-</span> timedfR<span class="sc">$</span>date</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>rdates <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(demodates, py_to_r) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">.name_repair =</span> <span class="sc">~</span><span class="st">'Date'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> Date)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But what was much faster was to convert the column to strings in python with</p>
<div class="cell" data-hash="py_r_dates_cache/html/unnamed-chunk-8_3c1b3535bdd8166529d388985dbce0f8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>timedf[<span class="st">'date_str'</span>] <span class="op">=</span> timedf[<span class="st">'date'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>timedf.info()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1000 entries, 0 to 999
Data columns (total 5 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   rand_nums   1000 non-null   float64       
 1   rand_chars  1000 non-null   object        
 2   date        1000 non-null   datetime64[ns]
 3   date2       1000 non-null   datetime64[ns]
 4   date_str    1000 non-null   object        
dtypes: datetime64[ns](2), float64(1), object(2)
memory usage: 39.2+ KB</code></pre>
</div>
</div>
<p>And then <code>lubridate</code> back to dates in R</p>
<div class="cell" data-hash="py_r_dates_cache/html/unnamed-chunk-9_bad820539462f2f7da91c55e4bbaaf2d">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>timedfRstr <span class="ot">&lt;-</span> py<span class="sc">$</span>timedf</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>timedfRstr <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(timedfRstr, <span class="sc">-</span>date) <span class="sc">|&gt;</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">date =</span> lubridate<span class="sc">::</span><span class="fu">ymd</span>(date_str))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(timedfRstr)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1000 obs. of  5 variables:
 $ rand_nums : num  -1.436 0.351 1.46 -0.88 -0.761 ...
 $ rand_chars: chr  "U" "e" "w" "u" ...
 $ date2     : POSIXct, format: "2000-01-01 11:00:00" "2000-01-02 11:00:00" ...
 $ date_str  : chr  "2000-01-01" "2000-01-02" "2000-01-03" "2000-01-04" ...
 $ date      : Date, format: "2000-01-01" "2000-01-02" ...
 - attr(*, "pandas.index")=RangeIndex(start=0, stop=1000, step=1)</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>